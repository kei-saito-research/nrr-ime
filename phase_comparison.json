{
  "metadata": {
    "date": "2026-01-30T08:03:57.082361",
    "model": "claude-sonnet-4-20250514",
    "scenario": "bank_5turns",
    "baseline": "Phase 1.0 Naive NRR"
  },
  "phases": {
    "1.0_naive": {
      "description": "Naive NRR - State sent as JSON each turn",
      "total_tokens": 1431,
      "avg_per_turn": 286.2,
      "turn_details": [
        {
          "turn": 1,
          "total": 180,
          "input": 109,
          "output": 71
        },
        {
          "turn": 2,
          "total": 316,
          "input": 174,
          "output": 142
        },
        {
          "turn": 3,
          "total": 310,
          "input": 172,
          "output": 138
        },
        {
          "turn": 4,
          "total": 313,
          "input": 175,
          "output": 138
        },
        {
          "turn": 5,
          "total": 312,
          "input": 174,
          "output": 138
        }
      ],
      "reduction_vs_naive": "0%"
    },
    "1.5_operator": {
      "description": "Operator-based NRR - External state, operator abstraction",
      "total_tokens": 436,
      "avg_per_turn": 87.2,
      "turn_details": [
        {
          "turn": 1,
          "total": 75,
          "input": 66,
          "output": 9
        },
        {
          "turn": 2,
          "total": 91,
          "input": 79,
          "output": 12
        },
        {
          "turn": 3,
          "total": 88,
          "input": 77,
          "output": 11
        },
        {
          "turn": 4,
          "total": 92,
          "input": 80,
          "output": 12
        },
        {
          "turn": 5,
          "total": 90,
          "input": 79,
          "output": 11
        }
      ],
      "reduction_vs_naive": "69.5%",
      "stability": "High - tested on 5 and 10 turns"
    },
    "1.6_compressed": {
      "description": "Compressed prompts - Over-optimization attempt",
      "total_tokens": 673,
      "avg_per_turn": 134.6,
      "turn_details": [
        {
          "turn": 1,
          "total": 54,
          "input": 43,
          "output": 11
        },
        {
          "turn": 2,
          "total": 139,
          "input": 45,
          "output": 94
        },
        {
          "turn": 3,
          "total": 166,
          "input": 43,
          "output": 123
        },
        {
          "turn": 4,
          "total": 168,
          "input": 46,
          "output": 122
        },
        {
          "turn": 5,
          "total": 146,
          "input": 45,
          "output": 101
        }
      ],
      "reduction_vs_naive": "53.0%",
      "note": "Failed - Output exploded due to unclear instructions"
    },
    "2.0_vector": {
      "description": "Vector-based - Embedding similarity",
      "total_tokens": 660,
      "avg_per_turn": 132.0,
      "turn_details": [
        {
          "turn": 1,
          "total": 309,
          "input": 0,
          "output": 0
        },
        {
          "turn": 2,
          "total": 88,
          "input": 0,
          "output": 0
        },
        {
          "turn": 3,
          "total": 86,
          "input": 0,
          "output": 0
        },
        {
          "turn": 4,
          "total": 89,
          "input": 0,
          "output": 0
        },
        {
          "turn": 5,
          "total": 88,
          "input": 0,
          "output": 0
        }
      ],
      "reduction_vs_naive": "53.9%",
      "note": "Failed - Embedding generation via Claude API too costly"
    },
    "3.0_hybrid": {
      "description": "Hybrid Router - Keyword matching with LLM fallback",
      "total_tokens": 56,
      "avg_per_turn": 11.2,
      "turn_details": [
        {
          "turn": 1,
          "total": 56,
          "input": 43,
          "output": 13,
          "method": "LLM"
        },
        {
          "turn": 2,
          "total": 0,
          "input": 0,
          "output": 0,
          "method": "AUTO"
        },
        {
          "turn": 3,
          "total": 0,
          "input": 0,
          "output": 0,
          "method": "AUTO"
        },
        {
          "turn": 4,
          "total": 0,
          "input": 0,
          "output": 0,
          "method": "AUTO"
        },
        {
          "turn": 5,
          "total": 0,
          "input": 0,
          "output": 0,
          "method": "AUTO"
        }
      ],
      "llm_calls": 1,
      "auto_calls": 4,
      "reduction_vs_naive": "96.1%",
      "note": "Excellent for domain-specific applications with clear keywords"
    }
  },
  "key_insights": {
    "input_reduction": "42.5% of savings (1.0\u21921.5)",
    "output_reduction": "57.5% of savings (1.0\u21921.5)",
    "lesson_1": "Clear instructions prevent verbose responses",
    "lesson_2": "Embedding generation via LLM APIs is inefficient",
    "lesson_3": "Domain knowledge enables dramatic optimization"
  }
}